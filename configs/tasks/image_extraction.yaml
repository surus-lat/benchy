# Image extraction evaluation task configuration

# Task identification
name: "image_extraction"
description: "Extract structured data from images following a JSON schema"

# Source directory for data (images, schema, expected values)
# This directory should contain:
#   - schema.json: JSON schema for extraction
#   - datos.json: Array of expected results with 'filename' field
#   - jpgs/: Directory with images named {filename}.jpg
source_dir: "/home/mauro/dev/benchy/test_image_request"

# Prompt templates
prompts:
  system: |
    You are an expert in extracting information from files. Extract all the required fields following the required schema.
  user: |
    Extract the data from this image following the provided schema.
    Return valid JSON matching the schema exactly.

# Default evaluation parameters
defaults:
  batch_size: 5  # Lower batch size for vision requests (more expensive)
  log_samples: true
  temperature: 0.0
  max_tokens: 2048
  timeout: 120
  max_retries: 3

# Metrics configuration (uses structured extraction metrics)
metrics:
  
  # String matching thresholds (more lenient for document extraction)
  partial_matching:
    string:
      token_overlap_weight: 0.5
      levenshtein_weight: 0.3
      containment_weight: 0.2
      exact_threshold: 0.85  # More lenient than default 0.95
      partial_threshold: 0.40  # More lenient than default 0.50
    number:
      relative_tolerance: 0.001
      absolute_tolerance: 1e-6
  
  # Document extraction score weights (emphasizes numeric accuracy)
  document_extraction_score:
    weights:
      numeric_precision: 0.50
      field_f1_partial: 0.35
      schema_validity: 0.15
  
  # Legacy extraction quality score (for compatibility)
  extraction_quality_score:
    enabled: true
    weights:
      schema_validity: 0.20
      field_f1_partial: 0.60
      inverted_hallucination: 0.20

# Output configuration
output:
  subdirectory: "image_extraction"



